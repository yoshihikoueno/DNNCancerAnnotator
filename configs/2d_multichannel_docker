FROM tensorflow/tensorflow:1.13.1-gpu-py3

RUN apt-get update && apt-get install -y git protobuf-compiler python3-pil python3-matplotlib python3-pip

RUN pip install connected-components-3d --no-binary :all:

run git clone --single-branch --branch dev https://github.com/yoshihikoueno/DNNCancerAnnotator
workdir DNNCancerAnnotator
RUN protoc protos/*.proto --python_out=.
CMD python3 -m train\
    --pipeline_config_file configs/2d_multichannel.config\
    --result_dir /kw_resources/results/annotation/multichannel\
    --num_train_steps 200000
