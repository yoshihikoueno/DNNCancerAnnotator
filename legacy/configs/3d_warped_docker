FROM tensorflow/tensorflow:1.13.1-gpu-py3
RUN apt-get update && apt-get install -y git protobuf-compiler python3-pil python3-matplotlib python3-pip
RUN pip install connected-components-3d --no-binary :all:
run git clone --single-branch --branch dev https://github.com/yoshihikoueno/DNNCancerAnnotator
workdir DNNCancerAnnotator
RUN protoc protos/*.proto --python_out=.
CMD python3 -m runs.train.py\
    --pipeline_config_file configs/3d_warped.config\
    --result_dir /kw_resources/results/annotation/3d/3d_warped_fix\
    --num_train_steps 300000
CMD python3 -m runs.eval.py\
    --checkpoint_dir /kw_resources/results/annotation/3d/3d_warped_fix\
    --all_checkpoints --use_gpu\
    --split_name val\
    --eval_checkpoint_step_interval 3000\
    --eval_name 2d
